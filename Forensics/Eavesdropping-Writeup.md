# üïµÔ∏è Eavesdropping

**Category:** Forensics

## üéØ Challenge Approach

In this challenge, we analyze a PCAP to decrypt an encrypted TLS conversation between two characters - Bob and Alice. Eve exploits an unauthenticated debug service to extract TLS session keys, which are then used to decrypt the traffic and reveal the flag.

## üîç Step 1: Initial Analysis

- Provided file: `Convo.pcapng` (network packet capture).
- Opened in Wireshark and checked Statistics ‚Üí Conversations ‚Üí TCP.
- Identified three key players based on IP addresses:
  - **Alice (Server):** `10.2.72.100` - Listening on ports 4433 (TLS) and 9001 (plaintext).
  - **Bob (Client):** `10.2.78.53` - Connected to Alice on port 4433.
  - **Eve (Attacker):** `10.2.38.203` - Connected to Alice on port 9001.
- Suspicious finding: Alice has two open ports - the "port sorcery" mentioned in the challenge description.

## üîê Step 2: Core Technique

- **TLS Decryption using SSLKEYLOGFILE**
- This method was chosen because:
  - The Bob‚ÜîAlice traffic on port 4433 was TLS 1.3 encrypted.
  - Eve's connection on port 9001 was plaintext and revealed she sent a `DEBUG_DUMP_TLS` command.
  - Alice responded with complete TLS session keys in SSLKEYLOGFILE format.
- Key observation: Alice doesn't authenticate incoming messages and assumes all requests come from Bob, allowing Eve to impersonate Bob and request a key dump.

## üíª Step 3: Implementation

1. Filtered traffic: `tcp.port == 9001`.
2. Follow ‚Üí TCP Stream.
3. Observed Eve's command: `DEBUG_DUMP_TLS`.
4. Copied Alice's response containing TLS secrets:
   ```
   # TLS secrets log file, generated by OpenSSL / Python
   SERVER_HANDSHAKE_TRAFFIC_SECRET 20c1b3b6... 5ef8de1c...
   CLIENT_HANDSHAKE_TRAFFIC_SECRET 20c1b3b6... 35804e12...
   EXPORTER_SECRET 20c1b3b6... 3fa33203...
   SERVER_TRAFFIC_SECRET_0 20c1b3b6... 5ecb327a...
   CLIENT_TRAFFIC_SECRET_0 20c1b3b6... 5f618cb9...
   ```
5. Saved to `keylog.txt`.
6. In Wireshark: Edit ‚Üí Preferences ‚Üí Protocols ‚Üí TLS ‚Üí (Pre)-Master-Secret log filename ‚Üí selected `keylog.txt`.
7. Filtered: `tcp.port == 4433` to view decrypted traffic.
- Examined frame 2537 (Alice ‚Üí Bob) which now showed decrypted Data layer.
- Hex dump revealed:
  ```
  0000  73 74 61 74 75 73 3d 4f 4b 3b 70 61 79 6c 6f 61   status=OK;payloa
  0010  64 3d 52 50 54 76 32 00 ff 01 72 6f 6f 74 7b 40   d=RPTv2...root{@
  0020  5f 74 40 6c 33 5f 40 35 5f 30 6c 64 5f 40 35 5f   _t@l3_@5_0ld_@5_
  0030  74 21 6d 33 7d 00 45 4e 44                        t!m3}.END
  ```
- Decoded payload: `status=OK;payload=RPTv2...root{@_t@l3_@5_0ld_@5_t!m3}...END`.
- Flag extracted from the decrypted application data.

## üèÅ Final Flag

```
root{@_t@l3_@5_0ld_@5_t!m3}
```

## üõ†Ô∏è Tools Used

| Tool | Purpose |
|------|---------|
| Wireshark | To analyze the PCAP. |

---

<div align="center">

**[‚Üê Back to Home](../README.md)** | **[‚Üê Previous](Docker-Writeup.md)** | **[Next ‚Üí](REDACTED-Writeup.md)**

**Forensics**

*Last Updated: February 9, 2026*

</div>
